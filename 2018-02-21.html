<html>

<head>

<title>IRC Log for #duraspace on irc.freenode.net, collected by DuraLogBot</title>

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="description" content="IRC Log for #duraspace" />
<meta name="keywords" content="IRC Log for #duraspace" />

<style type="text/css">
body {
    background: #ffffff;
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
    color: #000000;
}
.irc-date  {font-family: Courier New, Courier, mono;}
.irc-green {color: #009200;}
.irc-black {color: #000000;}
.irc-brown {color: #7b0000;}
.irc-navy  {color: #00007b;}
.irc-brick {color: #9c009c;}
.irc-red   {color: #ff0000;}
}
</style>

</head>

<body>

<h1>#duraspace IRC Log</h1>

<p>
 <a href="index.html">Index</a>
</p>

<h2>IRC Log for 2018-02-21
</h2>
<p>
 Timestamps are in GMT/BST.
</p>

<p><span class="irc-date">[2:05]</span> <span class="irc-navy">* kompewter (~kompewter@50.17.201.82) Quit (Ping timeout: 255 seconds)</span><br />
<span class="irc-date">[2:05]</span> <span class="irc-navy">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) Quit (Ping timeout: 276 seconds)</span><br />
<span class="irc-date">[3:00]</span> <span class="irc-green">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) has joined #duraspace</span><br />
<span class="irc-date">[3:02]</span> <span class="irc-navy">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) Quit (Remote host closed the connection)</span><br />
<span class="irc-date">[3:02]</span> <span class="irc-green">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) has joined #duraspace</span><br />
<span class="irc-date">[3:07]</span> <span class="irc-green">* kompewter (~kompewter@50.17.201.82) has joined #duraspace</span><br />
<span class="irc-date">[6:48]</span> <span class="irc-brown">-adams.freenode.net- *** Looking up your hostname...</span><br />
<span class="irc-date">[6:48]</span> <span class="irc-brown">-adams.freenode.net- *** Checking Ident</span><br />
<span class="irc-date">[6:48]</span> <span class="irc-brown">-adams.freenode.net- *** Found your hostname</span><br />
<span class="irc-date">[6:48]</span> <span class="irc-brown">-adams.freenode.net- *** No Ident response</span><br />
<span class="irc-date">[6:49]</span> <span class="irc-green">* DuraLogBot (~PircBot@webster.duraspace.org) has joined #duraspace</span><br />
<span class="irc-date">[6:49]</span> <span class="irc-green">* Topic is 'Welcome to DuraSpace IRC. This channel is used for formal meetings and is logged - <a href="http://irclogs.duraspace.org/'">http://irclogs.duraspace.org/'</a></span><br />
<span class="irc-date">[6:49]</span> <span class="irc-green">* Set by tdonohue on Thu Sep 15 17:49:38 UTC 2016</span><br />
<span class="irc-date">[8:41]</span> <span class="irc-navy">* kompewter (~kompewter@50.17.201.82) Quit (Read error: Connection reset by peer)</span><br />
<span class="irc-date">[8:41]</span> <span class="irc-navy">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) Quit (Read error: Connection reset by peer)</span><br />
<span class="irc-date">[9:00]</span> <span class="irc-green">* DSpaceSlackBot (~DSpaceSla@ec2-50-17-201-82.compute-1.amazonaws.com) has joined #duraspace</span><br />
<span class="irc-date">[9:02]</span> <span class="irc-green">* kompewter (~kompewter@50.17.201.82) has joined #duraspace</span><br />
<span class="irc-date">[12:43]</span> <span class="irc-green">* tdonohue (~tdonohue@dspace/tdonohue) has joined #duraspace</span><br />
<span class="irc-date">[14:20]</span> <span class="irc-navy">* tdonohue (~tdonohue@dspace/tdonohue) Quit (Read error: Connection reset by peer)</span><br />
<span class="irc-date">[14:22]</span> <span class="irc-green">* tdonohue (~tdonohue@dspace/tdonohue) has joined #duraspace</span><br />
<span class="irc-date">[14:51]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Reminder that our DSpace DevMtg is in about 10 mins (15UTC) here. Our light agenda is at <a href="https://wiki.duraspace.org/display/DSPACE/DevMtg+2018-02-21">https://wiki.duraspace.org/display/DSPACE/DevMtg+2018-02-21</a></span><br />
<span class="irc-date">[14:51]</span> <span class="irc-black">&lt;kompewter&gt; [ DevMtg 2018-02-21 - DSpace - DuraSpace Wiki ] - <a href="https://wiki.duraspace.org/display/DSPACE/DevMtg+2018-02-21">https://wiki.duraspace.org/display/DSPACE/DevMtg+2018-02-21</a></span><br />
<span class="irc-date">[15:00]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; &lt;here&gt;: it's DSpace DevMtg time.  See agenda above :point_up:</span><br />
<span class="irc-date">[15:00]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Let's do a quick roll call to see who's joining us today</span><br />
<span class="irc-date">[15:01]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; (crickets)   Looks like several of our usual suspects aren't here today yet.</span><br />
<span class="irc-date">[15:02]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Well, I'll post some general info here for anyone listening/reading....and we'll see if anyone else pops in.</span><br />
<span class="irc-date">[15:03]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; As noted in the Agenda, the next DSpace 7 Mtg is tomorrow (15UTC). If you are curious about current status, this spreadsheet gives a high level status of what's done / in progress: <a href="https://docs.google.com/spreadsheets/d/18brPF7cZy_UKyj97Ta44UJg5Z8OwJGi7PLoPJVz-g3g/edit#gid=0">https://docs.google.com/spreadsheets/d/18brPF7cZy_UKyj97Ta44UJg5Z8OwJGi7PLoPJVz-g3g/edit#gid=0</a></span><br />
<span class="irc-date">[15:03]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace 7 Development Planning - Google Sheets ] - <a href="https://docs.google.com/spreadsheets/d/18brPF7cZy_UKyj97Ta44UJg5Z8OwJGi7PLoPJVz-g3g/edit#gid=0">https://docs.google.com/spreadsheets/d/18brPF7cZy_UKyj97Ta44UJg5Z8OwJGi7PLoPJVz-g3g/edit#gid=0</a></span><br />
<span class="irc-date">[15:04]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; sorry.  here</span><br />
<span class="irc-date">[15:04]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Also, we have our next meeting of the DSpace Entities Group (see entities-wg channel in Slack) on Friday at 15UTC.  Anyone interested in data modeling &amp; improving how DSpace handles objects and metadata (in the future) may be interested to attend...or you can watch the recording which will be posted after the mtg</span><br />
<span class="irc-date">[15:05]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; And, we have our first (ever) Developer Show &amp; Tell meeting next Tues, Feb 27 at 16UTC (thanks to @terrywbrady).  For more info see <a href="https://wiki.duraspace.org/display/DSPACE/DSpace+on+AWS%2C+Janitor+and+DSpace+-+Feb+27%2C+2018+at+1600UTC">https://wiki.duraspace.org/display/DSPACE/DSpace+on+AWS%2C+Janitor+and+DSpace+-+Feb+27%2C+2018+at+1600UTC</a></span><br />
<span class="irc-date">[15:05]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace on AWS, Janitor and DSpace - Feb 27, 2018 at 1600UTC - DSpace - DuraSpace Wiki ] - <a href="https://wiki.duraspace.org/display/DSPACE/DSpace+on+AWS%2C+Janitor+and+DSpace+-+Feb+27%2C+2018+at+1600UTC">https://wiki.duraspace.org/display/DSPACE/DSpace+on+AWS%2C+Janitor+and+DSpace+-+Feb+27%2C+2018+at+1600UTC</a></span><br />
<span class="irc-date">[15:06]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; So, those three upcoming meetings are all good opportunities to contribute / and generally get more info on upcoming DSpace work. Plus the last two will be recorded</span><br />
<span class="irc-date">[15:06]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Anyone else joining us today, or is it just @terrywbrady and I?  (and hi, @terrywbrady)</span><br />
<span class="irc-date">[15:07]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; hi @tdonohue</span><br />
<span class="irc-date">[15:08]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I'm hearing a whole lot of silence, so I don't think we have an official quorum of any sort. Not sure there's much we can achieve with just two of us here ;)</span><br />
<span class="irc-date">[15:09]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I will note though that the Code Style work is coming (soon). I've had a busy week full of too many surprises (small fires to put out)...so, I haven't gotten back to rebasing the big PR. But, I should today</span><br />
<span class="irc-date">[15:09]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Other than that, I don't have anything to share here.</span><br />
<span class="irc-date">[15:09]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I owe @mwood a test of PR 1955.</span><br />
<span class="irc-date">[15:09]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I am excited by the progress that I made running DSpace on Codenvy.</span><br />
<span class="irc-date">[15:10]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @terrywbrady: it sounds like great progress. A part of me wishes *you* were presenting at the Show &amp; Tell next week. I'd love to see it</span><br />
<span class="irc-date">[15:10]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; @ptrottier gave the process a test and was able to replicate the experience.  <a href="https://github.com/DSpace-Labs/DSpace-codenvy/blob/master/README.md">https://github.com/DSpace-Labs/DSpace-codenvy/blob/master/README.md</a></span><br />
<span class="irc-date">[15:10]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace-codenvy/README.md at master · DSpace-Labs/DSpace-codenvy · GitHub ] - <a href="https://github.com/DSpace-Labs/DSpace-codenvy/blob/master/README.md">https://github.com/DSpace-Labs/DSpace-codenvy/blob/master/README.md</a></span><br />
<span class="irc-date">[15:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; We will work it into an agenda soon.</span><br />
<span class="irc-date">[15:12]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I suspect that there may be smarter ways to configure Docker to help things persist.  (Currently a full rebuild is needed after every server restart.)</span><br />
<span class="irc-date">[15:12]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; aha. Well, there's always ways to improve things later.  First step is to just get it working at a basic level, and it sounds like you have</span><br />
<span class="irc-date">[15:13]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; In any case, since it's still just the two of us, I'd recommend we simply cancel for today. I don't think there's anything we can accomplish alone.  And, I can use this time to then get back to rebasing my massive code style PR: DSPR#1952</span><br />
<span class="irc-date">[15:14]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://github.com/DSpace/DSpace/pull/1952">https://github.com/DSpace/DSpace/pull/1952</a> ] - Align Java code with new Code Style by tdonohue Âˇ Pull Request #1952 Âˇ DSpace/DSpace Âˇ GitHub</span><br />
<span class="irc-date">[15:14]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; <a href="https://github.com/DSpace/DSpace/pull/1952">https://github.com/DSpace/DSpace/pull/1952</a></span><br />
<span class="irc-date">[15:14]</span> <span class="irc-black">&lt;kompewter&gt; [ Align Java code with new Code Style by tdonohue · Pull Request #1952 · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/pull/1952">https://github.com/DSpace/DSpace/pull/1952</a></span><br />
<span class="irc-date">[15:14]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Sounds good.  Can I sneak in one question?  I posted a Jira bug about handle sequences after an AIP restore.</span><br />
<span class="irc-date">[15:15]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; oh, yes, go ahead. I tried to answer that a bit on dev on Monday, but not sure I understood the issue fully</span><br />
<span class="irc-date">[15:15]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Should the AIP command force an update of the handle sequence since this is a known point where the command could be needed.</span><br />
<span class="irc-date">[15:15]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; DS-3844 is the ticket (for others listening)</span><br />
<span class="irc-date">[15:15]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-3844">https://jira.duraspace.org/browse/DS-3844</a> ] - [DS-3844] Sequences are not updated by AIP RESTORE - DuraSpace JIRA</span><br />
<span class="irc-date">[15:15]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Thanks for the reference.</span><br />
<span class="irc-date">[15:17]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I'm definitely not against the AIP command triggering a handle sequence update.  However, it'd need to first figure out what database type you have, in order to run the proper `update-sequences.sql`... or we'd have to turn `update-sequences.sql` into a more easily call-able Java command (e.g. `dspace database update-sequences`)</span><br />
<span class="irc-date">[15:18]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I just did a quick review of that ticket and I mention something that might be an additional bug (related to handle.additional.prefixes) introduced.  I would need to compare 5x and 6x behavior side by side to be sure.</span><br />
<span class="irc-date">[15:18]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; So, the idea is good...just would take some thought in how to implement it in a consistent manner.</span><br />
<span class="irc-date">[15:18]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; OK. I will grab the ticket.</span><br />
<span class="irc-date">[15:19]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; `update-sequences.sql` is a sorta odd thing right now. When I implemented the Flyway DB stuff in Database (back in 5x.), I never had time to figure out how best to rework `update-sequences.sql`...and I ended up just leaving it alone</span><br />
<span class="irc-date">[15:19]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Sounds good</span><br />
<span class="irc-date">[15:19]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Yeah.  I see how that one will be tricky to work in with Hibernate.</span><br />
<span class="irc-date">[15:20]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Would you call this ticket Minor or Major?</span><br />
<span class="irc-date">[15:21]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; It's minor priority in my mind, as  it's a known issue with documented workarounds (just run update-sequences).  But, that doesn't mean I wouldn't still like it fixed/improved ;)</span><br />
<span class="irc-date">[15:21]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Sounds good.  Thanks for looking at that with me.</span><br />
<span class="irc-date">[15:22]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; And definitely feel free to bring back ideas/brainstorms to this meeting.  I'm glad to help brainstorm how to improve this.  I'm still not sure myself whether there's ways we can turn this into a Java command, or if we just work with it how it is in a SQL script</span><br />
<span class="irc-date">[15:23]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I would like for it to be automatic, but the command line option would be an improvement over the current process.</span><br />
<span class="irc-date">[15:23]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Personally, it might be nice to have it be a Java command, as it's easier to run using `dspace database update-sequences` than to figure out the `psql` equivalent.  But, I'm not sure if that becomes harder with Hibernate, etc</span><br />
<span class="irc-date">[15:23]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; The 6.3 collection of tickets is actually becoming a substantial amount of fixes.</span><br />
<span class="irc-date">[15:24]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; automatic is nice, but I don't think we'll be able to automate *every* scenario where this script is useful. So, I'd say it *has* to be a script that can be run manually...but if we can automate it in certain scenarios, that's great!</span><br />
<span class="irc-date">[15:25]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Ah, this is the first time that I have needed it, but I can imagine there are other times where it becomes necessary.</span><br />
<span class="irc-date">[15:25]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Yes, 6.3 won't end up being all those tickets...I see that larger list as just a list of "things under possible review for 6.3".  In all likelihood, 6.3 will be much smaller subset</span><br />
<span class="irc-date">[15:25]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; heya, sorry, super distracted this morning, my kids had a delayed start due to the ice on the roads</span><br />
<span class="irc-date">[15:25]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; he's been quiet during this meeting, but I'm pretty sure @tom_desair is lurking today</span><br />
<span class="irc-date">[15:26]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @terrywbrady: yes, update-sequences.sql is needed anytime sequences get out of sync.  It doesn't happen much (usually during AIP restores, or manual Postgres database restores/migrations)...but it see it enough on mailing lists that I think we need to keep a way to run it manually for scenarios where it's needed.</span><br />
<span class="irc-date">[15:27]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; It would be nice to have the "dspace database repair" able to detect when it is needed.</span><br />
<span class="irc-date">[15:27]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; yes, a script to run it would be a good first step and would let us document it instead of answering questions on th email list</span><br />
<span class="irc-date">[15:27]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I added our chat notes to the ticket as a reference</span><br />
<span class="irc-date">[15:28]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @terrywbrady: that's a good idea, if it's "detectable" easily</span><br />
<span class="irc-date">[15:29]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; detection could be as simple as seeing if the next handle actually would work</span><br />
<span class="irc-date">[15:29]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @terrywbrady: though it cannot be called "repair".  We already have that script...`dspace database repair` already triggers a Flyway DB repair (which is perhaps not the best name...it doesn't 'repair' much, but just tells Flyway to ignore database migration checksum mis-matches)</span><br />
<span class="irc-date">[15:29]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; but, some other name with the same concept would be great</span><br />
<span class="irc-date">[15:30]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Good info.  I forgot that is the context for "repair"</span><br />
<span class="irc-date">[15:31]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: it's not just correcting handle sequences though. It corrects *all sequences*.  Handles are the most likely to go awry</span><br />
<span class="irc-date">[15:31]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; and the error message that is sent if the handle can't be made could be changed to suggest running the update sequences script</span><br />
<span class="irc-date">[15:32]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; I wonder if we could just make sequences self-healing?</span><br />
<span class="irc-date">[15:32]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: hmm...possibly.</span><br />
<span class="irc-date">[15:32]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; @hpottinger, that is an interesting idea</span><br />
<span class="irc-date">[15:32]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; It should be easy to detect: You could check, if the max value of the id is less than the value of the sequence.</span><br />
<span class="irc-date">[15:33]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; You know what... we might be able to turn this into a Flyway *callback script* that is triggered anytime you start up Tomcat</span><br />
<span class="irc-date">[15:33]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; @sulfrian is right, that's how the update sequences SQL actually works</span><br />
<span class="irc-date">[15:33]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; that would simplify the hibernate issue</span><br />
<span class="irc-date">[15:34]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; Action: hpottinger is starting to get pretty excited about 6.3 now</span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Flyway callback scripts can be setup to run either before or after Flyway triggers...we have a few of them already: 1) Here's one that checks for "pgcrypto" to be installed in Postgres (as it's required for DSpace 6.x): <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/PostgreSQLCryptoChecker.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/PostgreSQLCryptoChecker.java</a> 2) Here's one that updates the metadata / bitstream format registri</span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseRegistryUpdater.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseRegistryUpdater.java</a> 3) Here's one that creates the Admin/Anon groups if they are missing: <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/GroupServiceInitializer.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/GroupServiceInitializer.java</a></span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace/PostgreSQLCryptoChecker.java at master · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/PostgreSQLCryptoChecker.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/PostgreSQLCryptoChecker.java</a></span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; I spent my Presidents Day holiday working on DSpace stuff... but that's probably the biggest block of volunteer time I'm going to have for a while</span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace/DatabaseRegistryUpdater.java at master · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseRegistryUpdater.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/DatabaseRegistryUpdater.java</a></span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace/GroupServiceInitializer.java at master · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/GroupServiceInitializer.java">https://github.com/DSpace/DSpace/blob/master/dspace-api/src/main/java/org/dspace/storage/rdbms/GroupServiceInitializer.java</a></span><br />
<span class="irc-date">[15:37]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; So, hypothetically, we should be able to have a Flyway Callback that checks each sequence...and if it's out-of-date, updates it.</span><br />
<span class="irc-date">[15:38]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; let's make a ticket for that</span><br />
<span class="irc-date">[15:38]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; And this could be triggered either before or after Flyway runs...it's up to us</span><br />
<span class="irc-date">[15:39]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; at Servlet startup is probably the best time for sequence surgery</span><br />
<span class="irc-date">[15:40]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Technically this would trigger whenever Flyway is triggered.  Flyway gets triggered at servlet startup, but also when you run certain CLI tools (those that need a database connection).  Essentially, Flyway is triggered on the first connection to the database</span><br />
<span class="irc-date">[15:40]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I was imagining that we would re-write each sequence to do a smarter calculation...</span><br />
<span class="irc-date">[15:41]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Perhaps that would not  perform welll.</span><br />
<span class="irc-date">[15:42]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I'm not sure what you mean by that, @terrywbrady.  I think we need these sequences...we don't want to change all our queries to have to find the new "max(handle)" every time we assign a new handle. That would degrade performance over time, as more and more handles are added...finding the "max" would take longer and longer</span><br />
<span class="irc-date">[15:42]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; But, I think updating these sequences when they are wrong can be done via a Flyway Callback, or similar</span><br />
<span class="irc-date">[15:43]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; That was my first imagining from Hardy's suggestion for "self-healing" but I agree that could be a performance issue.</span><br />
<span class="irc-date">[15:43]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; The handle stuff is currently doing a regex_replace on every handle. I do not know if it performs so well, that we want to execute on every startup.</span><br />
<span class="irc-date">[15:44]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @sulfrian: good question. I'm not sure myself... we'd have to test it.</span><br />
<span class="irc-date">[15:44]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; (Would be easier if the handle would be stored in two columns.)</span><br />
<span class="irc-date">[15:44]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; But, yes, the Handle sequence is a much more complex query to update: <a href="https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71">https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71</a></span><br />
<span class="irc-date">[15:45]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace/update-sequences.sql at master · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71">https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71</a></span><br />
<span class="irc-date">[15:46]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Perhaps we could look into a way to "detect" if the handle sequence needs an update (one that may be better performing), before we'd run this update.   But, I'm not sure off the top of my head what that'd be</span><br />
<span class="irc-date">[15:47]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; To me though, it seems like the other 10-15 sequences are easier to script into a Flyway callback.  The Handle sequence likely could be...but may take a bit more thought</span><br />
<span class="irc-date">[15:47]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; If the handle suffix would be in its own BIGINT column, it would be the same query like the other sequences.</span><br />
<span class="irc-date">[15:48]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @sulfrian: yes, but that's a more complex change...it's a database migration that'd need to happen in a major release</span><br />
<span class="irc-date">[15:48]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Not all handles in a repo have the same prefix</span><br />
<span class="irc-date">[15:48]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; @tdonohue Yes. I know.</span><br />
<span class="irc-date">[15:48]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; @terrywbrady You would need two columns. One for the prefix and one for the suffix.</span><br />
<span class="irc-date">[15:50]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; In general, it sounds like we've generated some good ideas here to start moving forward.  There's some questions about the handle prefix updates that might take more digging / performance testing for large numbers of handles.</span><br />
<span class="irc-date">[15:50]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I will add the rest of this conversation into 3844.</span><br />
<span class="irc-date">[15:50]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; I have claimed the ticket, but I would be delighted to relinquish it if someone else is ready to get started</span><br />
<span class="irc-date">[15:51]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; And I think it'd be very doable to script this into both a CLI tool (`dspace database update-sequences`) and a Flyway Callback, if we felt there's still a need to run it manually.  You'd just create the CLI tool, and have a Flyway Callback call its methods via Java.</span><br />
<span class="irc-date">[15:52]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; But, I'm not sure we'd need both...it really depends on whether we feel we can automate the handle sequence updates via Flyway.  If the performance isn't great, we may need to leave that out of Flyway and provide a manual way to run it / automate it only for certain scenarios (like AIP restore)</span><br />
<span class="irc-date">[15:54]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; you know, our startup isn't exactly speedy anyway, I think we can handle a bit more lag on startup</span><br />
<span class="irc-date">[15:55]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; Ok, well, good discussion after a "canceled" meeting. Thanks @terrywbrady, @hpottinger and @sulfrian;)   As we are nearly at the hour, I'm not going to bring up any other topics</span><br />
<span class="irc-date">[15:55]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Good discussion... even if we did not get dismissed early.</span><br />
<span class="irc-date">[15:56]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: depends entirely on how much "a bit more lag" it is ;)  For small sites, it likely wouldn't be noticeable.  But, once you get up to hundreds of thousands (or millions) of Handles (and remember, Communities/Collections also get Handles), then we'd need to make sure the "lag" doesn't turn into minutes</span><br />
<span class="irc-date">[15:57]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; it's easy to find a max</span><br />
<span class="irc-date">[15:57]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; It's something that should be testable though... generate a large number of handles...and see how this query performs</span><br />
<span class="irc-date">[15:57]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: no, not with Handles.  Look again: <a href="https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71">https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71</a></span><br />
<span class="irc-date">[15:58]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace/update-sequences.sql at master · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71">https://github.com/DSpace/DSpace/blob/master/dspace/etc/postgres/update-sequences.sql#L71</a></span><br />
<span class="irc-date">[15:58]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: the concern is that "regex_replace" *on every handle*</span><br />
<span class="irc-date">[15:58]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; when you start running millions of regexp_replace calls, I'm not sure how well that'll perform</span><br />
<span class="irc-date">[15:59]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; *all* the other sequences though are simple "max()" calls...those should be fine.  It's only the "handle_seq" that could have performance issues</span><br />
<span class="irc-date">[16:00]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; hmm... perhaps an opt-out configuration</span><br />
<span class="irc-date">[16:00]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; I think there was a similar concern for something else Flyway does every time Tomcat starts</span><br />
<span class="irc-date">[16:00]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I think we need to simply test it first. See what the performance implication is.  We're guessing right now.</span><br />
<span class="irc-date">[16:02]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; The other concern was with the automatic Solr reindex that Flway triggers *only after a database change is made*.  That obviously has performance issues as you are reindexing everything...but it's necessary for certain types of DB changes.</span><br />
<span class="irc-date">[16:02]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; But, that's a different scenario than this Handle Seq.  So, it's a bit off topic ;)</span><br />
<span class="irc-date">[16:03]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; In any case...I'm heading into lurking now. I want to get to rebasing my code style PR</span><br />
<span class="irc-date">[16:03]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; thanks again all for the good discussion / ideas</span><br />
<span class="irc-date">[16:03]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; right I'm thinking if we make an opt-out option for the sequence update that it'd be easy enough to add an opt-out option for the reindex</span><br />
<span class="irc-date">[16:05]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @hpottinger: There's already an "opt out" for automatic reindex. It's not simple yet though...but it's documented in step #11 of the upgrade process (see yellow note in that step): <a href="https://wiki.duraspace.org/display/DSDOC6x/Upgrading+DSpace">https://wiki.duraspace.org/display/DSDOC6x/Upgrading+DSpace</a></span><br />
<span class="irc-date">[16:05]</span> <span class="irc-black">&lt;kompewter&gt; [ Upgrading DSpace - DSpace 6.x Documentation - DuraSpace Wiki ] - <a href="https://wiki.duraspace.org/display/DSDOC6x/Upgrading+DSpace">https://wiki.duraspace.org/display/DSDOC6x/Upgrading+DSpace</a></span><br />
<span class="irc-date">[16:05]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;sulfrian&gt; Maybe we should try to split up the handle for DSpace7?</span><br />
<span class="irc-date">[16:05]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; We have 1million handles.  If I run the max/regex query it is taking about 2 sec.</span><br />
<span class="irc-date">[16:05]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @terrywbrady</span><br />
<span class="irc-date">[16:07]</span> <span class="irc-green">* mhwood (~mhwood@mhw.ulib.iupui.edu) has joined #duraspace</span><br />
<span class="irc-date">[16:09]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @sulfrian: not against it...but I admit I haven't analyzed it enough to see if it'd truly be that simple.  That said, the DSpace 7 effort is already rather large, and I'm not jumping to throw more tasks into that release, unless someone is volunteering for them and taking them on (and we verify they don't slow down other parallel efforts) ;)</span><br />
<span class="irc-date">[16:10]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; I will also note that (for some time now) there have been discussions about making DSpace _less tied_ to Handles (i.e. making its identifier scheme a bit more configurable to also support DOIs, or other external identifiers).  So, this might be fixed as part of that...but I'm not sure that effort will occur until DSpace 8 at the earliest</span><br />
<span class="irc-date">[16:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; oh, hey, speaking of DSpace 7, Open Repositories 2018 registration is open, and there are a couple of DSpace 7-related workshops you can sign up for</span><br />
<span class="irc-date">[16:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;hpottinger&gt; I've registered and I'm signed up for the REST-API workshop in the afternoon</span><br />
<span class="irc-date">[16:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; Action: tdonohue heading into "lurking" for real this time.  I'll be around, but getting back to my Code Style PR now</span><br />
<span class="irc-date">[16:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; Have a good day everyone</span><br />
<span class="irc-date">[16:13]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;terrywbrady&gt; If anyone has spare time for testing, the following 4 PR's could be tested in one session: <a href="https://github.com/terrywbrady/restReportTutorial/blob/master/README.md">https://github.com/terrywbrady/restReportTutorial/blob/master/README.md</a></span><br />
<span class="irc-date">[16:13]</span> <span class="irc-black">&lt;kompewter&gt; [ restReportTutorial/README.md at master · terrywbrady/restReportTutorial · GitHub ] - <a href="https://github.com/terrywbrady/restReportTutorial/blob/master/README.md">https://github.com/terrywbrady/restReportTutorial/blob/master/README.md</a></span><br />
<span class="irc-date">[16:49]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; Sorry I missed the meeting.  Do we have any notion of *why* sequences get out-of-sync?  Could we just *fix the problem*?</span><br />
<span class="irc-date">[16:51]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @mwood: unfortunately, no. The primary scenarios are handles sequences getting out of date after AIP restoration (as AIPs can be restored in a relatively random order).  But this has come up in other odd scenarios on mailing lists in past...sometimes after migrating databases (IIRC)</span><br />
<span class="irc-date">[16:52]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; But, this `update-sequences.sql` script has been around forever. We could search the email archives for every time it is mentioned...but, I'm not sure how informative that'd be overall</span><br />
<span class="irc-date">[16:57]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; So the underlying issue, for Handles at least, is that Handles are sometimes assigned by sequence and sometimes by an external source.  The Sequence doesn't know everything that is going on.</span><br />
<span class="irc-date">[17:01]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; I wonder what would be the cost of a stored procedure and a trigger on the sequenced column?  When inserting a row, compare the sequence to max(that column) [which should be really cheap -- it should be in one of the index pages already].  If the sequence is stale, set it to max+1 and continue.  Dunno how feasible this is -- I've never yet worked with either stored procedures or triggers.</span><br />
<span class="irc-date">[17:03]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; update-sequences.sql always felt like a kluge that we should get rid of someday.</span><br />
<span class="irc-date">[17:06]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @mwood: yes, it's worth analyzing.  I'm just not yet confident enough to say we can get rid of update-sequences altogether.  (Though, I too wish we could get rid of it)</span><br />
<span class="irc-date">[17:11]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; One other brainstorm, before I shut up:  stop using serial numbers for Handles.  Generate a UUID, BASE64 encode it for brevity, and retry on collision.</span><br />
<span class="irc-date">[17:12]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;mwood&gt; Sequences are cheap, but we may be abusing them.</span><br />
<span class="irc-date">[17:13]</span> <span class="irc-black">&lt;DSpaceSlackBot&gt; &lt;tdonohue&gt; @mwood: good point. UUIDs are something we didn't have before, so it forced us somewhat into sequences.  We do have an opportunity to rethink that approach</span><br />
<span class="irc-date">[22:02]</span> <span class="irc-navy">* mhwood (~mhwood@mhw.ulib.iupui.edu) Quit (Remote host closed the connection)</span><br />
<span class="irc-date">[22:48]</span> <span class="irc-navy">* tdonohue (~tdonohue@dspace/tdonohue) Quit (Quit: Leaving.)</span><br />
</p>

<p>
 These logs were automatically created by <b>DuraLogBot</b> on
 <a href="irc://irc.freenode.net/duraspace">irc.freenode.net</a>
 using the <a href="http://www.jibble.org/logbot/">Java IRC LogBot</a>.
</p>

</body>

</html>