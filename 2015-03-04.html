<html>

<head>

<title>IRC Log for #duraspace on irc.freenode.net, collected by DuraLogBot</title>

<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta name="description" content="IRC Log for #duraspace" />
<meta name="keywords" content="IRC Log for #duraspace" />

<style type="text/css">
body {
    background: #ffffff;
    font-family: Verdana, Arial, Helvetica, sans-serif;
    font-size: 12px;
    color: #000000;
}
.irc-date  {font-family: Courier New, Courier, mono;}
.irc-green {color: #009200;}
.irc-black {color: #000000;}
.irc-brown {color: #7b0000;}
.irc-navy  {color: #00007b;}
.irc-brick {color: #9c009c;}
.irc-red   {color: #ff0000;}
}
</style>

</head>

<body>

<h1>#duraspace IRC Log</h1>

<p>
 <a href="index.html">Index</a>
</p>

<h2>IRC Log for 2015-03-04
</h2>
<p>
 Timestamps are in GMT/BST.
</p>

<p><span class="irc-date">[6:42]</span> <span class="irc-brown">-cameron.freenode.net- *** Looking up your hostname...</span><br />
<span class="irc-date">[6:42]</span> <span class="irc-brown">-cameron.freenode.net- *** Checking Ident</span><br />
<span class="irc-date">[6:42]</span> <span class="irc-brown">-cameron.freenode.net- *** Found your hostname</span><br />
<span class="irc-date">[6:42]</span> <span class="irc-brown">-cameron.freenode.net- *** No Ident response</span><br />
<span class="irc-date">[6:42]</span> <span class="irc-green">* DuraLogBot (~PircBot@ec2-107-22-210-74.compute-1.amazonaws.com) has joined #duraspace</span><br />
<span class="irc-date">[6:42]</span> <span class="irc-green">* Topic is '[Welcome to DuraSpace - This channel is logged - <a href="http://irclogs.duraspace.org/]'">http://irclogs.duraspace.org/]'</a></span><br />
<span class="irc-date">[6:42]</span> <span class="irc-green">* Set by cwilper!ad579d86@gateway/web/freenode/ip.173.87.157.134 on Fri Oct 22 01:19:41 UTC 2010</span><br />
<span class="irc-date">[9:49]</span> <span class="irc-green">* pbecker (~pbecker@ubwstmapc098.ub.tu-berlin.de) has joined #duraspace</span><br />
<span class="irc-date">[13:53]</span> <span class="irc-green">* tdonohue (~tdonohue@c-98-215-0-161.hsd1.il.comcast.net) has joined #duraspace</span><br />
<span class="irc-date">[14:23]</span> <span class="irc-green">* awoods (~awoods@c-67-165-245-76.hsd1.co.comcast.net) has joined #duraspace</span><br />
<span class="irc-date">[14:56]</span> <span class="irc-green">* hpottinger (~hpottinge@mu-162188.dhcp.missouri.edu) has joined #duraspace</span><br />
<span class="irc-date">[15:33]</span> <span class="irc-green">* peterdietz (uid52203@gateway/web/irccloud.com/x-vovzoysayfagdkon) has joined #duraspace</span><br />
<span class="irc-date">[17:50]</span> <span class="irc-navy">* pbecker (~pbecker@ubwstmapc098.ub.tu-berlin.de) Quit (Quit: Leaving)</span><br />
<span class="irc-date">[18:29]</span> <span class="irc-navy">* hpottinger (~hpottinge@mu-162188.dhcp.missouri.edu) Quit (Quit: Leaving, later taterz!)</span><br />
<span class="irc-date">[18:46]</span> <span class="irc-green">* srobbins (~Adium@mobile-130-126-255-245.near.illinois.edu) has joined #duraspace</span><br />
<span class="irc-date">[19:15]</span> <span class="irc-navy">* srobbins (~Adium@mobile-130-126-255-245.near.illinois.edu) Quit (Quit: Leaving.)</span><br />
<span class="irc-date">[19:30]</span> <span class="irc-green">* hpottinger (~hpottinge@mu-162188.dhcp.missouri.edu) has joined #duraspace</span><br />
<span class="irc-date">[20:01]</span> <span class="irc-black">&lt;tdonohue&gt; Hey all, it's time for our weekly DSpace Developers Meeting : <a href="https://wiki.duraspace.org/display/DSPACE/DevMtg+2015-03-04">https://wiki.duraspace.org/display/DSPACE/DevMtg+2015-03-04</a></span><br />
<span class="irc-date">[20:01]</span> <span class="irc-black">&lt;kompewter&gt; [ DevMtg 2015-03-04 - DSpace - DuraSpace Wiki ] - <a href="https://wiki.duraspace.org/display/DSPACE/DevMtg+2015-03-04">https://wiki.duraspace.org/display/DSPACE/DevMtg+2015-03-04</a></span><br />
<span class="irc-date">[20:02]</span> <span class="irc-black">&lt;tdonohue&gt; I'm going to admit, today's agenda is a tad light...so, there's plenty of time for "open discussion" to occur</span><br />
<span class="irc-date">[20:02]</span> <span class="irc-black">&lt;tdonohue&gt; It also looks like we have a small attendee list (but maybe others are "playing along" view our IRC logs)</span><br />
<span class="irc-date">[20:03]</span> <span class="irc-black">&lt;tdonohue&gt; First up, as you all surely know &amp; saw.  DSpace 5.1, 4.3 and 3.4 were all released last week (and announced on lists).  Go forth and upgrade (and encourage others to do so!)</span><br />
<span class="irc-date">[20:03]</span> <span class="irc-black">&lt;hpottinger&gt; yay!!!!!!! :-)</span><br />
<span class="irc-date">[20:04]</span> <span class="irc-black">&lt;peterdietz&gt; Good to have that fix out there. Having a "dot" release out, should help adoption</span><br />
<span class="irc-date">[20:05]</span> <span class="irc-black">&lt;tdonohue&gt; Second, I'm going to be out-of-the-office (but still on email) for much of next week (Tues Mar 10 through Thurs, Mar 12).  If you haven't heard, the yearly "DuraSpace Member Summit" is next week in Washington, DC.  I'll be attending and reporting back on what goes on.</span><br />
<span class="irc-date">[20:05]</span> <span class="irc-green">* srobbins (~Adium@mobile-130-126-255-245.near.illinois.edu) has joined #duraspace</span><br />
<span class="irc-date">[20:05]</span> <span class="irc-black">&lt;tdonohue&gt; But, that does mean that I won't be able to attend this DevMtg next week (Weds, Mar 11).  Is there anyone who'd be willing to "lead the meeting" (or at least call the meeting to order)?</span><br />
<span class="irc-date">[20:06]</span> <span class="irc-black">&lt;hpottinger&gt; I'm sure we can find a volunter on that day, mhwood often leads the meetings if you have to be absent</span><br />
<span class="irc-date">[20:07]</span> <span class="irc-black">&lt;tdonohue&gt; Because of the small attendance today, I think it basically means that hpottinger &amp; peterdietz fight over who leads next week's meeting (or assign it to someone else not attending)</span><br />
<span class="irc-date">[20:07]</span> <span class="irc-black">&lt;hpottinger&gt; peterdietz, you want the gavel?</span><br />
<span class="irc-date">[20:07]</span> <span class="irc-black">&lt;peterdietz&gt; You can have it if you want it. I can take it otherwise</span><br />
<span class="irc-date">[20:08]</span> <span class="irc-brick">* hpottinger puts a large yellow post-it note, "HOLD FOR MHWOOD" on the gavel, hands it back to tdonohue.</span><br />
<span class="irc-date">[20:08]</span> <span class="irc-black">&lt;tdonohue&gt; Or, as you suggested, you all can "self organize" next week. :)   Honestly, there's not a ton pressing to discuss, but you can always just have open discussion (on whatever is on your minds) or do some more JIRA reviews, etc</span><br />
<span class="irc-date">[20:10]</span> <span class="irc-black">&lt;tdonohue&gt; So, I think we have a "good enough" solution for next week's meeting</span><br />
<span class="irc-date">[20:11]</span> <span class="irc-black">&lt;hpottinger&gt; Whenever we have more people in the room, we can discuss when we want to bump all our dependency versions</span><br />
<span class="irc-date">[20:11]</span> <span class="irc-black">&lt;tdonohue&gt; Beyond that, honestly, I'm leaving today mostly for "open discussion".  Anything DSpace related you all want to talk about?  Recent issues/questions?  Possible 6.0 features/brainstorms? Other stuff?</span><br />
<span class="irc-date">[20:12]</span> <span class="irc-black">&lt;peterdietz&gt; There ought to be the eventual discussion on Author Profiles / CRIS, plenty of time before OR15</span><br />
<span class="irc-date">[20:12]</span> <span class="irc-black">&lt;hpottinger&gt; DS-2473</span><br />
<span class="irc-date">[20:12]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2473">https://jira.duraspace.org/browse/DS-2473</a> ] - [DS-2473] Bump dependency versions in DSpace:master - DuraSpace JIRA</span><br />
<span class="irc-date">[20:13]</span> <span class="irc-black">&lt;hpottinger&gt; right, now's the time to talk about big architecture/design stuff</span><br />
<span class="irc-date">[20:13]</span> <span class="irc-black">&lt;tdonohue&gt; peterdietz: good point &amp; reminder. We do need to resolve the "Author Profiles &amp; CRIS" discussions</span><br />
<span class="irc-date">[20:14]</span> <span class="irc-black">&lt;tdonohue&gt; I'm pretty sure both CINECA and @mire staff (higher ups though, I think) will be at the DuraSpace Summit next week. I could always bring up the Author Profiles &amp; CRIS stuff with them again as a reminder too</span><br />
<span class="irc-date">[20:14]</span> <span class="irc-black">&lt;hpottinger&gt; in searching for 2473, I also found DS-2264 which has an embedded TODO</span><br />
<span class="irc-date">[20:14]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2264">https://jira.duraspace.org/browse/DS-2264</a> ] - [DS-2264] Lock DSpace 5.x dependency versions for Mirage 2 - DuraSpace JIRA</span><br />
<span class="irc-date">[20:16]</span> <span class="irc-black">&lt;tdonohue&gt; Do we want to talk DS-2473 then?</span><br />
<span class="irc-date">[20:16]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2473">https://jira.duraspace.org/browse/DS-2473</a> ] - [DS-2473] Bump dependency versions in DSpace:master - DuraSpace JIRA</span><br />
<span class="irc-date">[20:16]</span> <span class="irc-navy">* srobbins (~Adium@mobile-130-126-255-245.near.illinois.edu) Quit (Quit: Leaving.)</span><br />
<span class="irc-date">[20:17]</span> <span class="irc-black">&lt;tdonohue&gt; Honestly, with 2473, my opinion is we should just start upgrading things that "look reasonable" (but perhaps avoid major version upgrades, as those tend to require code changes) and see if anything breaks</span><br />
<span class="irc-date">[20:18]</span> <span class="irc-black">&lt;hpottinger&gt; DS-2266 is the "TODO" they were good</span><br />
<span class="irc-date">[20:18]</span> <span class="irc-black">&lt;tdonohue&gt; Anything that is a major version upgrade may require more care...as it's more likely we'll need code changes/tweaks</span><br />
<span class="irc-date">[20:18]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2266">https://jira.duraspace.org/browse/DS-2266</a> ] - [DS-2266] Rely on latest Mirage 2 dependency versions for DSpace 6 development - DuraSpace JIRA</span><br />
<span class="irc-date">[20:18]</span> <span class="irc-black">&lt;peterdietz&gt; sounds fair. Things like bumping javax servlet from 2.5 to 3 or 3.1 ought to be handled with care</span><br />
<span class="irc-date">[20:19]</span> <span class="irc-black">&lt;tdonohue&gt; hpottinger: 2266 doesn't sound "safe" to me. We should analyze it similar to 2473....and we shouldn't just let DSpace (even if it is "master") just download the latest version of any dependencies</span><br />
<span class="irc-date">[20:20]</span> <span class="irc-black">&lt;tdonohue&gt; Since we always release major versions from "master" we'd constantly need to "rollback" any Mirage 2 latest dependencies prior to release</span><br />
<span class="irc-date">[20:21]</span> <span class="irc-black">&lt;hpottinger&gt; Hmm... I dunno, DS-2264 I don't think was intended to be permanent...</span><br />
<span class="irc-date">[20:21]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2264">https://jira.duraspace.org/browse/DS-2264</a> ] - [DS-2264] Lock DSpace 5.x dependency versions for Mirage 2 - DuraSpace JIRA</span><br />
<span class="irc-date">[20:22]</span> <span class="irc-black">&lt;hpottinger&gt; anyway, it's dependency update season</span><br />
<span class="irc-date">[20:22]</span> <span class="irc-black">&lt;hpottinger&gt; and big changes should step on up :-)</span><br />
<span class="irc-date">[20:23]</span> <span class="irc-black">&lt;tdonohue&gt; hpottinger: not saying that 2264 was intended to be "permanent". I'm just saying that having "boostrap-sass-official" version set to "latest" is potentially dangerous...we might forget to remove it and "lock it down" again for 6.0</span><br />
<span class="irc-date">[20:23]</span> <span class="irc-green">* aschweer (~schweer@schweer.its.waikato.ac.nz) has joined #duraspace</span><br />
<span class="irc-date">[20:23]</span> <span class="irc-black">&lt;hpottinger&gt; OK, so, possibly we want to skip DS-2266?</span><br />
<span class="irc-date">[20:23]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2266">https://jira.duraspace.org/browse/DS-2266</a> ] - [DS-2266] Rely on latest Mirage 2 dependency versions for DSpace 6 development - DuraSpace JIRA</span><br />
<span class="irc-date">[20:25]</span> <span class="irc-black">&lt;aschweer&gt; can't we use the same mechanism for Mirage 2 then for the maven dependencies? as in, use fixed version numbers and periodically someone updates those and runs a ton of testing?</span><br />
<span class="irc-date">[20:25]</span> <span class="irc-black">&lt;aschweer&gt; that round for Mirage 2 should probably just be closer to testathon, while the maven dependencies should come early in the new version (around now, like you just discussed)</span><br />
<span class="irc-date">[20:25]</span> <span class="irc-black">&lt;hpottinger&gt; I think that may be the best choice, I've added a comment to DS-2266</span><br />
<span class="irc-date">[20:25]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2266">https://jira.duraspace.org/browse/DS-2266</a> ] - [DS-2266] Rely on latest Mirage 2 dependency versions for DSpace 6 development - DuraSpace JIRA</span><br />
<span class="irc-date">[20:26]</span> <span class="irc-black">&lt;tdonohue&gt; +1 aschweer: that's what I just commented on DS-2266, that we keep versions as fixed numbers</span><br />
<span class="irc-date">[20:26]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2266">https://jira.duraspace.org/browse/DS-2266</a> ] - [DS-2266] Rely on latest Mirage 2 dependency versions for DSpace 6 development - DuraSpace JIRA</span><br />
<span class="irc-date">[20:27]</span> <span class="irc-black">&lt;aschweer&gt; yup that looks great, thanks tdonohue</span><br />
<span class="irc-date">[20:28]</span> <span class="irc-black">&lt;tdonohue&gt; In general though, I'm perfectly fine with anyone starting to "claim" DS-2473 (or this 2266 Mirage2 ticket) and upgrading dependencies.  Now is the time to start trying this out, and discover which are easy and which may need more work (i.e. a separate ticket even)</span><br />
<span class="irc-date">[20:28]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2473">https://jira.duraspace.org/browse/DS-2473</a> ] - [DS-2473] Bump dependency versions in DSpace:master - DuraSpace JIRA</span><br />
<span class="irc-date">[20:28]</span> <span class="irc-black">&lt;hpottinger&gt; oh, hey, somewhat-related question: who wants to build some tests? DS-2288, DS-2397</span><br />
<span class="irc-date">[20:29]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2288">https://jira.duraspace.org/browse/DS-2288</a> ] - [DS-2288] Acceptance test suite - DuraSpace JIRA</span><br />
<span class="irc-date">[20:29]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2397">https://jira.duraspace.org/browse/DS-2397</a> ] - [DS-2397] Sort out Unit vs. Integration tests, and run them separately - DuraSpace JIRA</span><br />
<span class="irc-date">[20:30]</span> <span class="irc-black">&lt;hpottinger&gt; unit tests will probably catch *some* problems from bumping dependencies, acceptance and integration tests would catch more</span><br />
<span class="irc-date">[20:31]</span> <span class="irc-black">&lt;tdonohue&gt; I wish I had time right now...but I'd be glad to try to chip in where I can &amp; help review the work  (if someone else kicks things off). I think more tests could help in a *lot* of areas</span><br />
<span class="irc-date">[20:32]</span> <span class="irc-black">&lt;tdonohue&gt; Any other topics on folks minds?</span><br />
<span class="irc-date">[20:33]</span> <span class="irc-black">&lt;tdonohue&gt; Oh, and as a sidenote...just a reminder that the OR15 "Developer Track" proposals are due next week (March 13): <a href="http://www.or2015.net/developer-track/">http://www.or2015.net/developer-track/</a></span><br />
<span class="irc-date">[20:33]</span> <span class="irc-black">&lt;kompewter&gt; [ Developer Track at OR2015 | OPEN REPOSITORIES 2015 ] - <a href="http://www.or2015.net/developer-track/">http://www.or2015.net/developer-track/</a></span><br />
<span class="irc-date">[20:33]</span> <span class="irc-black">&lt;aschweer&gt; DS-2212 made me think, we've always had upgrade scripts for the database schema, do we need to make sure there is something like that for the usage stats data?</span><br />
<span class="irc-date">[20:33]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2212">https://jira.duraspace.org/browse/DS-2212</a> ] - [DS-2212] Statistics Shard not working on old records without a uid &amp;amp; cannot recover from error - DuraSpace JIRA</span><br />
<span class="irc-date">[20:34]</span> <span class="irc-black">&lt;tdonohue&gt; aschweer: we have auto-Solr-index upgrades (in DSpace 5).  But, it sounds like 2212 needs more than that</span><br />
<span class="irc-date">[20:35]</span> <span class="irc-black">&lt;tdonohue&gt; aschweer: have we figured out the proper "fix"?  If so, it might be possible to automate in some way</span><br />
<span class="irc-date">[20:35]</span> <span class="irc-black">&lt;aschweer&gt; tdonohue: and the auto-upgrade is much much better than forcing people to manually upgrade the indexes as we had for people who skipped 3 and went straight to 4</span><br />
<span class="irc-date">[20:35]</span> <span class="irc-black">&lt;aschweer&gt; there are two issues, one is adding the uid and one is the _version_ mismatch</span><br />
<span class="irc-date">[20:35]</span> <span class="irc-black">&lt;aschweer&gt; Terry's code works well for adding the uid; the process is a bit awkward and I don't know whether it'd be easy to automate this</span><br />
<span class="irc-date">[20:36]</span> <span class="irc-black">&lt;aschweer&gt; essentially you need to create a new solr core with the same config as the statistics core, copy over all the solr documents in batches of 100,000 or so, then swap over and use the new core for the stats</span><br />
<span class="irc-date">[20:37]</span> <span class="irc-black">&lt;aschweer&gt; the _version_ mismatch during the sharding, Terry's code adresses that by simply dropping the _version_ field during the sharding, which to me looks like it won't cause problems since the sharding creates new cores anyway and the _version_ is just supposed to help when existing docs are updated</span><br />
<span class="irc-date">[20:38]</span> <span class="irc-black">&lt;aschweer&gt; but I'd be a lot more comfortable for someone with more solr knowledge to look this over (preferably @mire since they enabled the _version_ field in the first place)</span><br />
<span class="irc-date">[20:38]</span> <span class="irc-black">&lt;tdonohue&gt; yuck. So, do we know the exact "cause" here? Is this actually a DSpace problem? Is it more a Solr data upgrade issue?  (It's sounding like the latter, but I need to dig in more here too)</span><br />
<span class="irc-date">[20:38]</span> <span class="irc-black">&lt;aschweer&gt; I guess what I would like to see is a commitment from us that schema changes in the solr stats won't happen unless we also provide support for people to upgrade their data</span><br />
<span class="irc-date">[20:39]</span> <span class="irc-black">&lt;aschweer&gt; tdonohue: the root cause of the uid issue is that there was a schema change in DSpace 3 that introduced the uid field. before then, stats docs had no unique keys.</span><br />
<span class="irc-date">[20:39]</span> <span class="irc-navy">* awoods (~awoods@c-67-165-245-76.hsd1.co.comcast.net) Quit (Ping timeout: 245 seconds)</span><br />
<span class="irc-date">[20:40]</span> <span class="irc-black">&lt;aschweer&gt; however, when the uid field was added to the schema, no attempt was made to retrospectively add uids to the existing docs (and the delete and re-index approach is the only one that works, since you can't uniquely identify a document to change if it doesn't have a unique key)</span><br />
<span class="irc-date">[20:40]</span> <span class="irc-black">&lt;tdonohue&gt; Oh, I see. Yea, that should have come with a way to "fix your data" in the DSpace 3 -&gt; 4 upgrade</span><br />
<span class="irc-date">[20:40]</span> <span class="irc-black">&lt;aschweer&gt; in the 1.8 -&gt; 3 upgrade, but yes</span><br />
<span class="irc-date">[20:40]</span> <span class="irc-black">&lt;tdonohue&gt; oh, right</span><br />
<span class="irc-date">[20:40]</span> <span class="irc-black">&lt;aschweer&gt; then the _version_ field was added later, I'm not sure why</span><br />
<span class="irc-date">[20:41]</span> <span class="irc-black">&lt;aschweer&gt; which is why it'd be great for someone who was involved in that decision to figure out what is going on</span><br />
<span class="irc-date">[20:41]</span> <span class="irc-black">&lt;aschweer&gt; for some reason, when Terry's code is run to retrospectively add the uids, the sharding process fails with a _version_ mismatch error</span><br />
<span class="irc-date">[20:41]</span> <span class="irc-black">&lt;aschweer&gt; see <a href="http://heliosearch.org/solr/optimistic-concurrency/">http://heliosearch.org/solr/optimistic-concurrency/</a> for info on _version_</span><br />
<span class="irc-date">[20:41]</span> <span class="irc-black">&lt;kompewter&gt; [ Optimistic Concurrency Solr Tutorial ] - <a href="http://heliosearch.org/solr/optimistic-concurrency/">http://heliosearch.org/solr/optimistic-concurrency/</a></span><br />
<span class="irc-date">[20:41]</span> <span class="irc-black">&lt;tdonohue&gt; Could you add those "analysis" details to the ticket? I don't see any mention of when these fields were added (1.8 -&gt; 3 upgrade), and therefore what DSpace instances may encounter this</span><br />
<span class="irc-date">[20:42]</span> <span class="irc-black">&lt;aschweer&gt; oh right, I think it's just in my e-mail to -tech/-dev that is referenced from the ticket</span><br />
<span class="irc-date">[20:43]</span> <span class="irc-black">&lt;tdonohue&gt; i.e. the ticket is a bit "confusing" to me, as it was unclear (until now) the exact *root cause* even though Terry has a fix.  Admittedly though, I don't know this area of the code very well</span><br />
<span class="irc-date">[20:43]</span> <span class="irc-black">&lt;aschweer&gt; so there may be a third issue, which is the docValues one. That's the third change to the solr schema, made recently. For me, it meant after the 4-&gt;5 upgrade, geographic information in the usage stats only covered the time since the upgrade</span><br />
<span class="irc-date">[20:44]</span> <span class="irc-black">&lt;aschweer&gt; running Terry's code fixed that for me, but that is to be expected since the re-index created the docValues</span><br />
<span class="irc-date">[20:44]</span> <span class="irc-black">&lt;aschweer&gt; and I have tons of local customisations in the usage stats</span><br />
<span class="irc-date">[20:45]</span> <span class="irc-black">&lt;aschweer&gt; so it would be good to know if anyone else has upgraded to 5 and is using the solr usage stats and can check whether the geographic information (downloads by city/country) shows data from all time or just since the upgrade</span><br />
<span class="irc-date">[20:45]</span> <span class="irc-black">&lt;tdonohue&gt; Sounds like we need to clarify here where the "problem points" are...then we might want to make @mire (and others) more aware of these "problem points" to see if they can help us resolve them in an easier manner.</span><br />
<span class="irc-date">[20:45]</span> <span class="irc-black">&lt;aschweer&gt; tdonohue agree</span><br />
<span class="irc-date">[20:45]</span> <span class="irc-black">&lt;aschweer&gt; from my point of view, there is one overarching problem - making changes to the solr schema without big fat warnings / providing help for people to migrate their existing data</span><br />
<span class="irc-date">[20:46]</span> <span class="irc-black">&lt;hpottinger&gt; I wouldn't mind testing.... but I have no idea how to copy a live solr core to another box</span><br />
<span class="irc-date">[20:46]</span> <span class="irc-black">&lt;aschweer&gt; then there are 3 examples of the problems this causes - the uids, the _version_, the docValues. Though it might be that there is really only the uid problem and the other two are flow-on</span><br />
<span class="irc-date">[20:46]</span> <span class="irc-black">&lt;tdonohue&gt; aschweer: would you be willing to potentially split these "problem areas" out into separate tickets?  Or clean up the existing one (or potentially add subtickets)</span><br />
<span class="irc-date">[20:46]</span> <span class="irc-black">&lt;aschweer&gt; hpottinger: I just e-mailed you :)</span><br />
<span class="irc-date">[20:47]</span> <span class="irc-black">&lt;tdonohue&gt; aschweer: I completely agree that we need to look *much closer* at any changes to Solr Schemas.  It's likely we all "assumed" things would be OK, but now we've learned otherwise</span><br />
<span class="irc-date">[20:47]</span> <span class="irc-black">&lt;aschweer&gt; tdonohue: I can try. I agree that this isn't clear at all in Jira at the moment. My issue is that my understanding of this is still evolving too</span><br />
<span class="irc-date">[20:47]</span> <span class="irc-black">&lt;aschweer&gt; for copying a solr stats core to a dev machine: copy the solr/statistics/data directory contents and delete the write.lock file that is somewhere in that directory (unless you stop tomcat before copying) -- you might lose the last few hits, so if you're worried, just force a commit on the stats core first</span><br />
<span class="irc-date">[20:48]</span> <span class="irc-black">&lt;aschweer&gt; to force a commit, run eg curl --globoff '<a href="http://localhost:8080/solr/statistics/update?commit=true'">http://localhost:8080/solr/statistics/update?commit=true'</a></span><br />
<span class="irc-date">[20:48]</span> <span class="irc-black">&lt;tdonohue&gt; aschweer: makes perfect sense. I guess I just want to be sure anything you "discover" / learn gets tracked (at some point) ;)  But, if you need more time to dig, feel free</span><br />
<span class="irc-date">[20:48]</span> <span class="irc-black">&lt;aschweer&gt; you might want to synch the db content first so that the item IDs etc resolve properly</span><br />
<span class="irc-date">[20:49]</span> <span class="irc-black">&lt;aschweer&gt; I'll give it a go on Jira, but I will definitely need help with testing -- as I said, our stats are so customised that I can't be sure how much of this is just "our problem" and how much affects everyone with stats data going back to DSpace 1.8</span><br />
<span class="irc-date">[20:50]</span> <span class="irc-black">&lt;tdonohue&gt; Thanks aschweer. I'm sure we can find some testers to help out. It sounds like (from 2212 and the stackoverflow issue) others are having this issue too: <a href="http://stackoverflow.com/questions/26941260/normalizing-solr-records-for-sharding-version-issues">http://stackoverflow.com/questions/26941260/normalizing-solr-records-for-sharding-version-issues</a></span><br />
<span class="irc-date">[20:50]</span> <span class="irc-black">&lt;kompewter&gt; [ dspace - Normalizing SOLR records for sharding: _version_ issues - Stack Overflow ] - <a href="http://stackoverflow.com/questions/26941260/normalizing-solr-records-for-sharding-version-issues">http://stackoverflow.com/questions/26941260/normalizing-solr-records-for-sharding-version-issues</a></span><br />
<span class="irc-date">[20:51]</span> <span class="irc-black">&lt;aschweer&gt; yes, the uid / _version_ one is definitely something others have run into too</span><br />
<span class="irc-date">[20:51]</span> <span class="irc-black">&lt;aschweer&gt; that one should affect everyone with solr stats data from 1.8 and now running 3, 4 or 5</span><br />
<span class="irc-date">[20:52]</span> <span class="irc-black">&lt;aschweer&gt; the docValues one as described in my e-mail, I'm not sure if that affects everyone with solr stats data from pre-5 now running 5, or just everyone also affected by the uid issue, or just us</span><br />
<span class="irc-date">[20:52]</span> <span class="irc-black">&lt;aschweer&gt; <a href="http://dspace.2283337.n4.nabble.com/DSpace-5-and-solr-usage-statistics-data-tt4676837.html">http://dspace.2283337.n4.nabble.com/DSpace-5-and-solr-usage-statistics-data-tt4676837.html</a></span><br />
<span class="irc-date">[20:52]</span> <span class="irc-black">&lt;kompewter&gt; [ DSpace - Tech - DSpace 5 and solr usage statistics data | Threaded View ] - <a href="http://dspace.2283337.n4.nabble.com/DSpace-5-and-solr-usage-statistics-data-tt4676837.html">http://dspace.2283337.n4.nabble.com/DSpace-5-and-solr-usage-statistics-data-tt4676837.html</a></span><br />
<span class="irc-date">[20:53]</span> <span class="irc-black">&lt;tdonohue&gt; good question on the "docValues". I don't know the answer, but it is worth keeping an eye out for</span><br />
<span class="irc-date">[20:55]</span> <span class="irc-green">* awoods (~awoods@c-67-165-245-76.hsd1.co.comcast.net) has joined #duraspace</span><br />
<span class="irc-date">[20:56]</span> <span class="irc-black">&lt;tdonohue&gt; Any other final notes / thoughts that anyone has to mention? I notice we are down to &lt;5mins</span><br />
<span class="irc-date">[20:56]</span> <span class="irc-black">&lt;tdonohue&gt; And aschweer, thanks for sharing what you've discovered. Hopefully we can get some sort of resolution to this problem soon. I definitely didn't realize the extent of the issue for older upgrades</span><br />
<span class="irc-date">[20:57]</span> <span class="irc-black">&lt;aschweer&gt; thanks tdonohue, I have some very frustrated repo managers wondering whether none of the devs care about usage statistics and I guess it is a fair point to ask whether we're committed to keeping that data safe across upgrades</span><br />
<span class="irc-date">[20:58]</span> <span class="irc-black">&lt;tdonohue&gt; I think we *are* committed to keeping the data safe. I think we just never realized it wasn't happening "automatically" already (and we need to be much more careful about changing the Solr Schemas going forward)</span><br />
<span class="irc-date">[20:59]</span> <span class="irc-black">&lt;hpottinger&gt; hands up who tests with a copy of a live stats core?</span><br />
<span class="irc-date">[20:59]</span> <span class="irc-brick">* aschweer puts hand up</span><br />
<span class="irc-date">[21:00]</span> <span class="irc-black">&lt;aschweer&gt; (looks like tumbleweeds otherwise, which may explain why nobody else has run into this before -- though I guess there aren't that many folks around today)</span><br />
<span class="irc-date">[21:01]</span> <span class="irc-black">&lt;tdonohue&gt; With 5.0, I admit to testing that the *Solr index version* upgraded successfully.... I didn't think to test that old data would auto-migrate (as we didn't make any Solr schema changes in 5.0, I had assumed that was already "taken care of")</span><br />
<span class="irc-date">[21:01]</span> <span class="irc-black">&lt;aschweer&gt; the docValues change was in 5.0, wasn't it?</span><br />
<span class="irc-date">[21:02]</span> <span class="irc-black">&lt;tdonohue&gt; hmmm...and it's possible I overlooked that :/</span><br />
<span class="irc-date">[21:02]</span> <span class="irc-black">&lt;aschweer&gt; <a href="https://github.com/DSpace/DSpace/commit/8e2f87e75548b48ad44c6257b47bf45af3e5b4ef">https://github.com/DSpace/DSpace/commit/8e2f87e75548b48ad44c6257b47bf45af3e5b4ef</a></span><br />
<span class="irc-date">[21:02]</span> <span class="irc-black">&lt;kompewter&gt; [ add docvalues to docvalue capable fields for better facet performance · 8e2f87e · DSpace/DSpace · GitHub ] - <a href="https://github.com/DSpace/DSpace/commit/8e2f87e75548b48ad44c6257b47bf45af3e5b4ef">https://github.com/DSpace/DSpace/commit/8e2f87e75548b48ad44c6257b47bf45af3e5b4ef</a></span><br />
<span class="irc-date">[21:02]</span> <span class="irc-black">&lt;aschweer&gt; it changes the way these fields are indexed, which means facets will only include those documents that have docValues. Now I don't know whether it would automatically create docValues for old docs if they had a uid.</span><br />
<span class="irc-date">[21:03]</span> <span class="irc-black">&lt;aschweer&gt; I suppose I could try adding the uids to a DSpace 4, then do the upgrade to 5 including the solr auto-upgrade and see whether the facets look better</span><br />
<span class="irc-date">[21:04]</span> <span class="irc-black">&lt;tdonohue&gt; I'll readily admit, my attention was much more on "making sure the database upgraded, and the Solr index version upgraded".  My (wrong) assumption was that anything that changed the Stats Solr Schema was taking care of updating existing data.</span><br />
<span class="irc-date">[21:05]</span> <span class="irc-black">&lt;tdonohue&gt; So, apologies if I overlooked it myself. I definitely think we need to find a better way to "refresh"/upgrade the Stats data...with Discovery we can just kick off a fully reindex (which actually happens automatically now with the 5 upgrade). But, that's not possible with Stats (obviously)</span><br />
<span class="irc-date">[21:06]</span> <span class="irc-black">&lt;aschweer&gt; yes, I agree. OAI is in the same boat as Discovery, so no problem there either. The authority core might have similar issues to statistics, in that it is the authoritative data source, not just an index into data that exists elsewhere</span><br />
<span class="irc-date">[21:07]</span> <span class="irc-black">&lt;hpottinger&gt; good catch</span><br />
<span class="irc-date">[21:07]</span> <span class="irc-black">&lt;aschweer&gt; and I guess another question is, might the Elasticsearch stats be affected by something like this one day too (I don't know anything about Elasticsearch, but again it is the authoritative source of usage stats data when enabled)</span><br />
<span class="irc-date">[21:09]</span> <span class="irc-black">&lt;aschweer&gt; sorry folks, I need to be elsewhere. I've started on sorting out the Jira issues around this, hopefully I'll get that finished today. Thanks for the discussion tdonohue and hpottinger, it's good to see that we're on the same page re keeping the data safe :)</span><br />
<span class="irc-date">[21:10]</span> <span class="irc-black">&lt;tdonohue&gt; While it's not *ideal*, I recall that in DSpace 5, it's now possible to *export* Solr Statistics (stats-util -e).  I wonder if a complete export &amp; reimport could help "refresh" things (but that could take a long time for a lot of data, I know)</span><br />
<span class="irc-date">[21:10]</span> <span class="irc-black">&lt;aschweer&gt; no, the export / re-import discards some information, if I saw correctly</span><br />
<span class="irc-date">[21:10]</span> <span class="irc-black">&lt;tdonohue&gt; ok, darn</span><br />
<span class="irc-date">[21:10]</span> <span class="irc-black">&lt;tdonohue&gt; (I was hoping maybe it was something "easy" we could recommend, even if it's not ideal yet)</span><br />
<span class="irc-date">[21:11]</span> <span class="irc-black">&lt;aschweer&gt; I believe it discards eg the user agent, geographical information (can be re-looked-up but if it's 2010 data, maybe not so awesome)</span><br />
<span class="irc-date">[21:11]</span> <span class="irc-black">&lt;tdonohue&gt; ok, good to know</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;hpottinger&gt; I know I've tried the "just copy and delete lock files" approach before, but maybe if I just try again, I'll have luck.</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;aschweer&gt; We could change the export code to export all fields, then delete all data , then re-import.</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;tdonohue&gt; Well, since we are "over time" here, we may as well close out the meeting for today.  Definitely sounds like DS-2212 needs more attention from anyone who can help!</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;kompewter&gt; [ <a href="https://jira.duraspace.org/browse/DS-2212">https://jira.duraspace.org/browse/DS-2212</a> ] - [DS-2212] Statistics Shard not working on old records without a uid &amp;amp; cannot recover from error - DuraSpace JIRA</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;aschweer&gt; the copy / delete lock file thing works for me -- tomcat on the dev machine needs to be down when you copy it, but nothing else I can think of</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-black">&lt;aschweer&gt; oh yes, and I really do need to be elsewhere. see you!</span><br />
<span class="irc-date">[21:12]</span> <span class="irc-navy">* aschweer (~schweer@schweer.its.waikato.ac.nz) Quit (Quit: leaving)</span><br />
<span class="irc-date">[21:13]</span> <span class="irc-black">&lt;hpottinger&gt; oh, duh, that makes sense, I bet that was the problem</span><br />
<span class="irc-date">[22:30]</span> <span class="irc-navy">* hpottinger (~hpottinge@mu-162188.dhcp.missouri.edu) Quit (Quit: Leaving, later taterz!)</span><br />
<span class="irc-date">[22:45]</span> <span class="irc-green">* tdonohue (~tdonohue@c-98-215-0-161.hsd1.il.comcast.net) has left #duraspace</span><br />
</p>

<p>
 These logs were automatically created by <b>DuraLogBot</b> on
 <a href="irc://irc.freenode.net/duraspace">irc.freenode.net</a>
 using the <a href="http://www.jibble.org/logbot/">Java IRC LogBot</a>.
</p>

</body>

</html>